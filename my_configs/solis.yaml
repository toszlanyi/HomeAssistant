# ============================================================================
# SOLIS HYBRID INVERTER - DASHBOARD ENTITÄTEN
# ============================================================================

template:
  - sensor:
      # --- PV ANLAGE ---
      - name: "Solis PV Erzeugung"
        unique_id: solis_pv_power_pure
        unit_of_measurement: "W"
        device_class: power
        state_class: measurement
        state: >
          {{ states('sensor.solis_raw_pv_power_total') | float(0) }}
        icon: mdi:solar-power-variant

      # --- WECHSELRICHTER AC ---
      - name: "Solis AC Ausgangsleistung"
        unique_id: solis_ac_power
        unit_of_measurement: "W"
        device_class: power
        state_class: measurement
        state: >
          {{ states('sensor.solis_raw_ac_p_total') | float(0) }}
        icon: mdi:flash-outline

      # --- BATTERIE SPEICHER ---
      - name: "Solis Batterie Leistung"
        unique_id: solis_batt_power
        unit_of_measurement: "W"
        device_class: power
        state_class: measurement
        state: >
          {{ states('sensor.solis_raw_batt_p') | float(0) }}
        icon: mdi:battery-charging-high

      - name: "Solis Batterie Füllstand"
        unique_id: solis_batt_soc
        unit_of_measurement: "%"
        device_class: battery
        state_class: measurement
       # state: >
       #   {{ states('sensor.solis_raw_batt_soc') | int(0) }}
        state: >
          {% set soc = states('sensor.solis_raw_batt_soc') %}
          {{ soc | int if is_number(soc) else 0 }}

      - name: "Solis Batterie Status"
        unique_id: solis_batt_status
        state: >
          {{ states('sensor.solis_raw_batt_status') }}
        icon: >
          {% if is_state('sensor.solis_raw_batt_status', 'Laden') %}
            mdi:battery-plus
          {% elif is_state('sensor.solis_raw_batt_status', 'Entladen') %}
            mdi:battery-minus
          {% else %}
            mdi:battery-clock
          {% endif %}

      # --- ERTRAGS-STATISTIKEN (kWh) ---
      - name: "Solis Ertrag Heute"
        unique_id: solis_yield_day
        unit_of_measurement: "kWh"
        device_class: energy
        state_class: total_increasing
        state: >
          {{ states('sensor.solis_raw_yield_day') | float(0) }}
        icon: mdi:calendar-today

      - name: "Solis Ertrag Monat"
        unique_id: solis_yield_month
        unit_of_measurement: "kWh"
        device_class: energy
        state_class: total_increasing
        state: >
          {{ states('sensor.solis_raw_yield_month') | float(0) }}
        icon: mdi:calendar-month

      - name: "Solis Ertrag Jahr"
        unique_id: solis_yield_year
        unit_of_measurement: "kWh"
        device_class: energy
        state_class: total_increasing
        state: >
          {{ states('sensor.solis_raw_yield_year') | float(0) }}
        icon: mdi:calendar-range

      - name: "Solis Ertrag Gesamt"
        unique_id: solis_yield_total
        unit_of_measurement: "kWh"
        device_class: energy
        state_class: total_increasing
        state: >
          {{ states('sensor.solis_raw_yield_total') | float(0) }}
        icon: mdi:counter

      # --- STRING DETAILS (Einzeln definiert) ---
      - name: "Solis String 1 Leistung"
        unique_id: solis_str1_p
        unit_of_measurement: "W"
        device_class: power
        state_class: measurement
        state: >
          {{ states('sensor.solis_raw_str1_p') | float(0) }}
        icon: mdi:solar-panel

      - name: "Solis String 2 Leistung"
        unique_id: solis_str2_p
        unit_of_measurement: "W"
        device_class: power
        state_class: measurement
        state: >
          {{ states('sensor.solis_raw_str2_p') | float(0) }}
        icon: mdi:solar-panel

      - name: "Solis String 3 Leistung"
        unique_id: solis_str3_p
        unit_of_measurement: "W"
        device_class: power
        state_class: measurement
        state: >
          {{ states('sensor.solis_raw_str3_p') | float(0) }}
        icon: mdi:solar-panel

      - name: "Solis String 4 Leistung"
        unique_id: solis_str4_p
        unit_of_measurement: "W"
        device_class: power
        state_class: measurement
        state: >
          {{ states('sensor.solis_raw_str4_p') | float(0) }}
        icon: mdi:solar-panel
